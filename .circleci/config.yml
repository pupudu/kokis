version: 2
jobs:
  publish:
    docker:
      - image: 'circleci/node:latest'
    steps:
      - checkout
      - run: yarn
      - run: yarn release
      - run: yarn changelog
      - run:
          name: 'commit release assets'
          command: |
            git remote set-url origin https://pupudu:${GH_TOKEN}@github.com/pupudu/kokis.git
            git config user.email pubudu.dodan@gmail.com
            git config user.name "Pubudu Dodangoda GH"
            git add package.json && git commit -m "chore: add release assets from CI 🏠 [skip ci]"
            git push

workflows:
  version: 2
  main:
    jobs:
      - publish:
          context: kokis
